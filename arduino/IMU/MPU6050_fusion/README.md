# IMU &#8594; MPU6050_fusion
* 본 폴더의 소스코드는 1차적으로 캡슐화를 마쳤음
* 밖에서 가져다 쓰고자 할 경우 ___헤더 파일만___ 보고 맞춰서 작성하면 된다
* ino 파일은 다른 센서들과의 호환 가능성을 열어둔 채 이 센서만 테스트하고자 할 때 적합
## 헤더 파일 구조
### IMU_Config
초기화할 때 IMU 관련 설정값들이 들어간다.
* frames: 이 숫자만큼의 샘플들을 평균내서 가속도와 각속도를 구한다.
* aThres: 가속도가 이 값보다 작으면 문제가 있는 것이다.
* omegaThres: 각속도가 이 값보다 작으면 문제 ㅇㅇ
### IMU_UpdateResult
IMU의 데이터를 한번 조회시도한 후 결과가 담겨서 나온다.
* hasData: 조회했으나 아직 데이터가 준비 안된 상태였다면 false로 나오고, 그러면 나머지 둘은 무시하면 된다.
* aMag: 중력을 제거한 순간 가속도 절댓값이다.
* omegaRate: 순간 각속도 절댓값이다.
### IMU_begin
* 설정값 받아서 IMU 초기화한다.
* 설정값 전달은 _IMU_Config_ 타입의 구조체를 생성해서 각 필드 채워주고 인자로 넘겨주면 된다.
* 잡다한 디버깅용 메시지 다 쳐내고 성공했는지만 리턴한다.
### IMU_update
* 실제로 값 조회를 시도하고 _IMU_UpdateResult_ 타입으로 결과를 알려준다.
* 인터럽트 기반은 아니지만 잘 작동하는 것으로 보인다.
### IMU_isNoMotion
* 지난 기록들을 전달받아서 움직임이 있는지 판단해준다.
* 가속도 배열과 각속도 배열을 기록해둔걸 넘겨주면 된다.
* _IMU_update_ 함수에 합치려면 합칠순 있지만 분리하는 것이 나을걸로 판단했다.
* 각 배열의 크기는 _frames_ 만큼이어야 한다.
## 예제 작동방식
1. 매크로로 설정값들 정의
1. 기록 버퍼 생성하고, 센서값 받아올 변수 선언
1. 구조체에 설정값들 넣어서 초기화
1. 값 받아와서 유효한지 검사
1. 배열에서 가장 오래된 값 덮어쓰기
1. 판단 함수 호출해서 결과 띄움